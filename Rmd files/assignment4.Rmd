---
title: "PSTAT 126 - Assignment 4"
subtitle: "Fall 2022"
author: "Kayla Katakis"
output:
  pdf_document:
    number_sections: true
---
_Note: **Submit both your `Rmd` and generated pdf file to Canvas.** Use the same indentation level as **Solution** markers to write your solutions. Improper indentation will break your document._

```{r setup, include=FALSE}
# formats rendered outputs from inline R code
# Register an inline hook:
knitr::knit_hooks$set(inline = function(x) {
  x <- sprintf("%1.2f", x)
  paste(x, collapse = ", ")
})
```

```{r message=FALSE}
library(alr4)
library(ggplot2)
data(UN11)
```

1. This problem uses the data set `UN11` from the `alr4` package.

    (a) Examine the figure generated by using `scatterplotMatrix` function for attributes (`fertility`, log(`ppgdp`), `pctUrban`), and comment on the marginal relationships.  

        **Solution**: 
        There are positive linear relationships between log(ppgdp) / pctUrban, and negative linear relationships between fertility / log(ppgdp) and fertility /pctUrban
```{r fig.height = 3.5, fig.width = 4.5}
attributes = cbind(UN11[3],log(UN11[4]),UN11[6])
colnames(attributes) <- c("fertility","log(ppgdp)","pctUrban")
scatterplotMatrix(attributes)
```

  (b) Fit the two simple regressions `fertility` $\sim$ log(`ppgdp`) and `fertility` $\sim$ `pctUrban`, and verify that the slopes are significantly different from zero at any conventional level of significance.  

        **Solution**:
        Both slopes are significant at any confidence level, as they both have p-values of approximately 0, which is less than 0.01, 0.05, and 0.1
```{r}
ppgdp_lm <-lm(fertility~log(ppgdp),UN11)
pctUrban_lm <- lm(fertility~pctUrban,UN11)
summary(ppgdp_lm) #slope is -0.62009
summary(pctUrban_lm) # slope is -0.031045
```
        

      
  (c) Obtain the added-variable plots for both predictors. Based on the added-variable plots, does log(`ppgdp`) seem to be useful after adjusting for `pctUrban`, and similarly, does `pctUrban` seem to be useful after adjusting for log(`ppgdp`)?  

        **Solution**: 
        Log(ppgdp) appears to be useful, as in still correlates with, fertility after adjusting for pctUrban, but pctUrban is not useful on its own (after adjusting for log(ppgdp)).
```{r fig.height = 4.5, fig.width = 8}
MLR_fertility <- lm(fertility~log(ppgdp)+pctUrban,UN11)
avPlots(MLR_fertility)
```
        



2. Consider a multiple linear regression model with two continuous predictors:  
$$
Y_i = \beta_0 + \beta_1 x_{i1} + \beta_2 x_{i2} + \varepsilon_i, \qquad \varepsilon_i \stackrel{iid}{\sim} \mathcal{N}(0, \sigma^2).
$$

    (a) Suppose that $x_{i1}$ and $x_{i2}$ are exactly related in that $x_{i1} = 2.2x_{i2}$ for all $i$. For example, $x_{i2}$ could be weight in kilograms and $x_{i1}$ weight in pounds for the $i$-th individual. Describe the appearance of the added variable plot for $x_{i2}$ after adjusting for $x_{i1}$.  

        **Solution**:  
        After adjusting for $x_{i1}$, the added variable plot for $x_{i2}$ would look the same, except for a slight downward shift in the intercept.

    b) Suppose that $x_{i1}$ and $x_{i2}$ are not perfectly correlated, but that $Y_i = 3x_{i1}$, i.e. $Y_i$ is perfectly correlated with $x_{i1}$. Describe the added-variable plot for $x_{i2}$.  

        **Solution**:
        The added variable plot for $x_{i2}$ would have a slope of 0, as $Y_i = 3x_{i1}$ implies that $x_{i2}$ does not predictc $Y_i$. 

    c) (**Bonus**):  Simulate some data for each of the situations in parts a) and b) and create an added-variable plot to confirm you answers.  

        **Solution**:  


